The 2004 Khobar massacre was carried out by a terrorist group affiliated with al-Qaeda. Specifically:

The attack was conducted by four armed men who described themselves as members of "The Jerusalem Squadron" or "Jerusalem Brigade" of the "Mujahedin of the Arabian Peninsula" - a Saudi Arabia-based faction of al-Qaeda[1].

Key details about the perpetrators and attack:

- It occurred on May 29-30, 2004 in Al-Khobar, Saudi Arabia[1].

- The attackers targeted oil industry installations and a residential compound housing foreign workers[1].

- They killed 22 people and injured 25, mainly foreign oil industry workers[1].

- The group claimed they were attacking "Zionists and Crusaders" in Saudi Arabia to "steal our oil and resources"[1].

- An audio tape was released in which Abdulaziz al-Muqrin, thought to be one of al-Qaeda's leaders in Saudi Arabia, took responsibility[1].

- The Jamestown Foundation identified the leader of the attack as Turki bin Fahd al-Moteiri, also known as Fawwaz al-Nashami[1].

- The attackers asked hostages if they were Christian or Muslim, letting Muslims go while killing non-Muslims[1].

While Iran and Hezbollah have been implicated in other attacks in Saudi Arabia, this particular 2004 Khobar attack is attributed to al-Qaeda affiliated militants rather than Iranian-backed groups[1][2]. The attack demonstrated al-Qaeda's continued ability to strike Western targets in Saudi Arabia at that time.